# Pull Requests

## Обзор

Этот документ описывает процесс создания и обработки Pull Request'ов в проекте. Следование этому процессу обеспечивает качество кода и эффективную совместную работу.

## Подготовка к работе

### 1. Форк репозитория

```bash
# Форкните репозиторий на GitHub
# Затем клонируйте свой форк
git clone https://github.com/YOUR_USERNAME/revin.git
cd revin

# Добавьте upstream репозиторий
git remote add upstream https://github.com/ORIGINAL_OWNER/revin.git
```

### 2. Настройка окружения

```bash
# Установите зависимости
npm install

# Запустите проект в режиме разработки
npm run dev

# Проверьте, что все работает
npm run build
```

### 3. Создание ветки

```bash
# Обновите main ветку
git checkout main
git pull upstream main

# Создайте новую ветку для вашей функции
git checkout -b feature/your-feature-name

# Или для исправления бага
git checkout -b fix/bug-description
```

**Соглашения по именованию веток:**
- `feature/` - новые функции
- `fix/` - исправления багов
- `docs/` - обновления документации
- `refactor/` - рефакторинг кода
- `test/` - добавление тестов

**Примеры:**
```bash
feature/add-vue-developer-role
fix/header-scroll-issue
docs/update-readme
refactor/portfolio-loading
test/add-validation-tests
```

## Процесс разработки

### 1. Планирование изменений

Перед началом работы:

- [ ] Создайте Issue для обсуждения изменений (если необходимо)
- [ ] Убедитесь, что изменения соответствуют целям проекта
- [ ] Проверьте, нет ли конфликтов с существующим кодом
- [ ] Подумайте о тестировании изменений

### 2. Разработка

```bash
# Делайте небольшие, логически завершенные коммиты
git add src/components/NewComponent.astro
git commit -m "feat: add new portfolio component"

# Регулярно синхронизируйтесь с main веткой
git fetch upstream
git rebase upstream/main
```

### 3. Тестирование

```bash
# Проверьте TypeScript
npm run astro check

# Проверьте стили
npm run stylelint

# Проверьте сборку
npm run build

# Запустите тесты (если есть)
npm test
```

### 4. Коммиты

**Структура коммита:**
```
<type>(<scope>): <description>

[optional body]

[optional footer]
```

**Типы коммитов:**
- `feat` - новая функция
- `fix` - исправление бага
- `docs` - изменения в документации
- `style` - форматирование, отсутствующие точки с запятой и т.д.
- `refactor` - рефакторинг кода
- `test` - добавление тестов
- `chore` - обновление задач сборки, конфигурации и т.д.

**Примеры:**
```bash
git commit -m "feat(portfolio): add Vue Developer role"
git commit -m "fix(header): resolve scroll animation issue"
git commit -m "docs(readme): update installation instructions"
git commit -m "refactor(components): extract common styles"
```

## Создание Pull Request

### 1. Подготовка

```bash
# Убедитесь, что все изменения зафиксированы
git status

# Отправьте ветку в ваш форк
git push origin feature/your-feature-name
```

### 2. Создание PR

1. Перейдите на GitHub и нажмите "New Pull Request"
2. Выберите правильные ветки (ваша ветка → main)
3. Заполните шаблон PR

### 3. Шаблон Pull Request

```markdown
## Описание

Краткое описание изменений и их цели.

## Тип изменений

- [ ] Исправление бага (не ломающее изменение)
- [ ] Новая функция (не ломающее изменение)
- [ ] Ломающее изменение (изменение, которое исправляет функцию или удаляет API)
- [ ] Обновление документации

## Что изменено

- [ ] Добавлен новый компонент
- [ ] Обновлена документация
- [ ] Изменены стили
- [ ] Добавлены тесты

## Как тестировать

1. Клонируйте репозиторий
2. Установите зависимости: `npm install`
3. Запустите проект: `npm run dev`
4. Проверьте [конкретные шаги для тестирования]

## Скриншоты (если применимо)

Добавьте скриншоты, если изменения затрагивают UI.

## Чеклист

- [ ] Мой код следует стилю проекта
- [ ] Я провел самотестирование своего кода
- [ ] Я прокомментировал код в сложных местах
- [ ] Мои изменения не генерируют новых предупреждений
- [ ] Я добавил тесты, которые доказывают, что мое исправление эффективно
- [ ] Новые и существующие unit тесты проходят локально с моими изменениями
- [ ] Любые зависимые изменения были объединены и опубликованы

## Дополнительные заметки

Любая дополнительная информация для ревьюеров.
```

## Ревью Pull Request

### Для автора PR

**Подготовка к ревью:**
- [ ] Убедитесь, что все проверки CI проходят
- [ ] Ответьте на комментарии ревьюеров
- [ ] Внесите необходимые изменения
- [ ] Обновите описание PR при необходимости

**Ответ на комментарии:**
```markdown
@reviewer Спасибо за комментарий! Я исправил [описание изменений]. 

Изменения:
- [конкретные изменения]
- [ссылки на коммиты если нужно]

Можете проверить еще раз?
```

### Для ревьюеров

**Что проверять:**

1. **Функциональность**
   - Код работает как ожидается
   - Нет регрессий
   - Обработка ошибок

2. **Качество кода**
   - Следование стилю проекта
   - Читаемость и понятность
   - Производительность

3. **Тестирование**
   - Покрытие тестами
   - Тестирование edge cases
   - Документация

4. **Безопасность**
   - Валидация входных данных
   - Отсутствие уязвимостей
   - Безопасные практики

**Комментарии:**

```markdown
// ✅ Хороший комментарий
Это хорошее решение! Небольшое предложение: можно добавить валидацию для случая, когда `items` пустой массив.

// ❌ Плохой комментарий
Это неправильно.
```

**Одобрение:**
- Используйте "Approve" только когда PR готов к мержу
- Оставьте комментарий с кратким резюме
- Убедитесь, что все проверки пройдены

## Мерж Pull Request

### Автоматический мерж

Если настроен автоматический мерж:
- [ ] Все проверки CI пройдены
- [ ] Получено одобрение от ревьюеров
- [ ] Нет конфликтов
- [ ] PR готов к мержу

### Ручной мерж

```bash
# Переключитесь на main ветку
git checkout main

# Обновите main ветку
git pull upstream main

# Мерж PR (замените PR_NUMBER на номер PR)
git merge pull/PR_NUMBER/head

# Или используйте squash merge
git merge --squash pull/PR_NUMBER/head
git commit -m "feat: add new portfolio component (#PR_NUMBER)"

# Отправьте изменения
git push upstream main
```

### После мержа

1. **Очистка:**
   ```bash
   # Удалите локальную ветку
   git branch -d feature/your-feature-name
   
   # Удалите ветку на GitHub
   git push origin --delete feature/your-feature-name
   ```

2. **Обновление документации:**
   - Обновите CHANGELOG.md
   - Обновите README.md если необходимо
   - Обновите документацию API

3. **Тестирование:**
   - Проверьте, что все работает в production
   - Мониторьте логи на предмет ошибок

## Обработка конфликтов

### Разрешение конфликтов

```bash
# Обновите main ветку
git checkout main
git pull upstream main

# Переключитесь на вашу ветку
git checkout feature/your-feature-name

# Сделайте rebase
git rebase main

# Разрешите конфликты в файлах
# Затем добавьте изменения
git add .
git rebase --continue

# Отправьте обновленную ветку
git push origin feature/your-feature-name --force-with-lease
```

### Предотвращение конфликтов

- Регулярно синхронизируйтесь с main веткой
- Делайте небольшие, частые коммиты
- Обсуждайте крупные изменения заранее
- Используйте feature flags для больших изменений

## Лучшие практики

### Для авторов PR

1. **Размер PR:**
   - Делайте PR небольшими и сфокусированными
   - Один PR = одна функция/исправление
   - Если PR большой, разбейте на несколько

2. **Описание:**
   - Четко опишите что и зачем изменено
   - Добавьте скриншоты для UI изменений
   - Укажите как тестировать

3. **Тестирование:**
   - Тестируйте свои изменения
   - Добавляйте тесты для нового кода
   - Проверяйте на разных устройствах/браузерах

### Для ревьюеров

1. **Время ответа:**
   - Отвечайте в течение 2 рабочих дней
   - Если не можете ревьюить, назначьте другого ревьюера

2. **Конструктивная критика:**
   - Будьте вежливы и конструктивны
   - Объясняйте почему что-то неправильно
   - Предлагайте альтернативы

3. **Одобрение:**
   - Не одобряйте PR, который не готов
   - Убедитесь, что понимаете все изменения
   - Проверьте, что все проверки пройдены

## Инструменты

### GitHub CLI

```bash
# Создание PR
gh pr create --title "feat: add new component" --body "Description"

# Просмотр PR
gh pr view

# Мерж PR
gh pr merge --squash
```

### Git hooks

Создайте `.git/hooks/pre-push`:

```bash
#!/bin/bash
npm run astro check
npm run build
```

### Автоматизация

Настройте GitHub Actions для:
- Автоматического запуска тестов
- Проверки стиля кода
- Сборки проекта
- Деплоя на staging

## Troubleshooting

### Частые проблемы

1. **PR не собирается:**
   - Проверьте логи CI
   - Убедитесь, что все зависимости установлены
   - Проверьте TypeScript ошибки

2. **Конфликты при мерже:**
   - Сделайте rebase с main
   - Разрешите конфликты вручную
   - Протестируйте после разрешения

3. **Ревью затягивается:**
   - Напомните ревьюерам
   - Попросите другого ревьюера
   - Обсудите в чате команды

### Получение помощи

- Создайте Issue с вопросом
- Обратитесь к maintainer'ам
- Проверьте существующую документацию
- Посмотрите на похожие PR в проекте
